# 09. ë°ì´í„° ì €ì¥ ë° ì „ë‹¬ ì „ëµ (Storage & Data Transfer)

ë°ì´í„° íŒŒì´í”„ë¼ì¸ì—ì„œ ì •ì œëœ ë°ì´í„°ë¥¼ ë°±í…ŒìŠ¤íŒ… ì—”ì§„ìœ¼ë¡œ ì–´ë–»ê²Œ ì „ë‹¬í•˜ê³ , ì–´ë–¤ DBë¥¼ ì„ íƒí•´ì•¼ í•˜ëŠ”ì§€ì— ëŒ€í•œ ê¸°ìˆ ì  ê°€ì´ë“œì…ë‹ˆë‹¤.

---

## ğŸ”„ ë°ì´í„° ì „ë‹¬ êµ¬ì¡°: DB vs File-based

ê²°ë¡ ë¶€í„° ë§ì”€ë“œë¦¬ë©´, í˜„ëŒ€ì ì¸ í€€íŠ¸ í”Œë«í¼ì—ì„œëŠ” **"ë©”íƒ€ë°ì´í„°ì™€ ì‹¤ì‹œê°„ ë°ì´í„°ëŠ” DB"**ì—, **"ëŒ€ëŸ‰ì˜ ë°±í…ŒìŠ¤íŒ…ìš© ì‹œê³„ì—´ ë°ì´í„°ëŠ” íŒŒì¼ í˜•ì‹(Parquet ë“±)"**ì— ì €ì¥í•˜ëŠ” í•˜ì´ë¸Œë¦¬ë“œ ë°©ì‹ì„ ì„ í˜¸í•©ë‹ˆë‹¤.

### 1. íŒŒì¼ ê¸°ë°˜ ì €ì¥ (S3 + Parquet) - ì¶”ì²œ
- **ë°©ì‹**: íŒŒì´í”„ë¼ì¸ì´ ì •ì œëœ ë°ì´í„°ë¥¼ `Parquet`ì´ë‚˜ `HDF5` í˜•ì‹ìœ¼ë¡œ ì €ì¥ì†Œ(S3)ì— ë–¨êµ¬ë©´, ë°±í…ŒìŠ¤íŒ… ì—”ì§„ì´ ì´ë¥¼ ì§ì ‘ ì½ì–´ ë©”ëª¨ë¦¬ì— ë¡œë“œ.
- **ì¥ì **: 
    - **ì†ë„**: DB ì—”ë“œí¬ì¸íŠ¸ë¥¼ ê±°ì¹˜ì§€ ì•Šê³  ë””ìŠ¤í¬ I/Oë¥¼ í†µí•´ ì§ì ‘ `Pandas`ë¡œ ì½ì–´ì˜¤ê¸° ë•Œë¬¸ì— ìˆ˜ì²œë§Œ ê±´ì˜ ë°ì´í„°ë¥¼ ë¡œë“œí•  ë•Œ ì••ë„ì ìœ¼ë¡œ ë¹ ë¦„.
    - **ë¹„ìš©**: DB ì¸ìŠ¤í„´ìŠ¤ ìœ ì§€ ë¹„ìš©ë³´ë‹¤ ìŠ¤í† ë¦¬ì§€ ë¹„ìš©ì´ í›¨ì”¬ ì €ë ´.
    - **ë²„ì „ ê´€ë¦¬**: íŠ¹ì • ì‹œì ì˜ ë°ì´í„° ìŠ¤ëƒ…ìƒ·ì„ íŒŒì¼ ë‹¨ìœ„ë¡œ ê´€ë¦¬í•˜ê¸° ìš©ì´.

### 2. DB ê¸°ë°˜ ì €ì¥ (PostgreSQL, TimescaleDB)
- **ë°©ì‹**: ì •ì œëœ ë°ì´í„°ë¥¼ DB í…Œì´ë¸”ì— Insert í•˜ê³ , ì—”ì§„ì´ SQL Queryë¡œ í•„ìš”í•œ ë°ì´í„°ë§Œ Select.
- **ì¥ì **: 
    - **ì •êµí•œ ì¿¼ë¦¬**: íŠ¹ì • ì¢…ëª©, íŠ¹ì • ê¸°ê°„ë§Œ í•„í„°ë§í•´ì„œ ê°€ì ¸ì˜¤ê¸° ì‰¬ì›€.
    - **ë°ì´í„° ë¬´ê²°ì„±**: íŠ¸ëœì­ì…˜ê³¼ ì œì•½ ì¡°ê±´ì„ í†µí•´ ë°ì´í„°ì˜ ì •í•©ì„±ì„ ì—„ê²©íˆ ê´€ë¦¬ ê°€ëŠ¥.
    - **ì‹¤ì‹œê°„ì„±**: ì‹¤ì‹œê°„ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ëŠ” ì£¼ê°€ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ê¸°ì— ì í•©.

---

## ğŸ—„ï¸ ì¶”ì²œí•˜ëŠ” DB ì•„í‚¤í…ì²˜

ë¯¸ë˜ì—ì…‹ìì‚°ìš´ìš©ê³¼ ê°™ì€ ëŒ€ê·œëª¨ í”Œë«í¼ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì¡°í•©ì„ ì¶”ì²œí•©ë‹ˆë‹¤.

### 1. PostgreSQL (RDBMS) - ë§ˆìŠ¤í„° ë°ì´í„° ë° ë©”íƒ€ë°ì´í„° ì „ìš©
- **ìš©ë„**: ì¢…ëª© ì •ë³´(ì„¹í„°, ìƒì¥ì¼ ë“±), ìœ ì € ì •ë³´, ë°±í…ŒìŠ¤íŒ… ì‹¤í–‰ ë¡œê·¸, ì „ëµ ë©”íƒ€ë°ì´í„°.
- **ì´ìœ **: ë³µì¡í•œ ê´€ê³„í˜• ë°ì´í„°ë¥¼ ê´€ë¦¬í•˜ê¸°ì— ê°€ì¥ ì•ˆì •ì ì´ë©°, `PostGIS` ë“±ì„ í†µí•´ í™•ì¥ì„±ë„ ì¢‹ìŒ.

### 2. TimescaleDB (Time-series) - ì‹œê³„ì—´ ë°ì´í„° ìµœì í™”
- **ìš©ë„**: ì¼ë³„/ë¶„ë³„ ì£¼ê°€ ë°ì´í„°, í˜¸ê°€ ë°ì´í„°.
- **ì´ìœ **: PostgreSQLì˜ í™•ì¥íŒìœ¼ë¡œ, ì‹œê³„ì—´ ë°ì´í„° ì²˜ë¦¬ì— íŠ¹í™”ëœ `Hypertable` ê¸°ëŠ¥ì„ ì œê³µí•˜ì—¬ ëŒ€ìš©ëŸ‰ ë°ì´í„° ì¡°íšŒ ì†ë„ê°€ ì¼ë°˜ DBë³´ë‹¤ í›¨ì”¬ ë¹ ë¦„.

### 3. Redis (In-memory) - ì‹¤ì‹œê°„ ìºì‹œ
- **ìš©ë„**: í˜„ì¬ê°€, ì‹¤ì‹œê°„ ì‹œê·¸ë„, ìì£¼ ì¡°íšŒë˜ëŠ” ì¸ë±ìŠ¤ ë°ì´í„°.
- **ì´ìœ **: ë°€ë¦¬ì´ˆ(ms) ë‹¨ìœ„ì˜ ì‘ë‹µ ì†ë„ê°€ í•„ìš”í•œ ë°ì´í„° ì„œë¹™ì— í•„ìˆ˜ì .

---

## ğŸš€ ë°±ì—”ë“œ ì—”ì§€ë‹ˆì–´ì˜ ì„¤ê³„ í¬ì¸íŠ¸ (ë©´ì ‘ ë‹µë³€ìš©)

> "ì €ëŠ” ë°ì´í„° íŒŒì´í”„ë¼ì¸ê³¼ ë°±í…ŒìŠ¤íŒ… ì—”ì§„ ì‚¬ì´ì˜ ê°€êµ ì—­í• ë¡œ **'Object Storage(S3) + Parquet'ì™€ 'TimescaleDB'ì˜ í•˜ì´ë¸Œë¦¬ë“œ êµ¬ì¡°**ë¥¼ ì œì•ˆí•©ë‹ˆë‹¤.
> 
> 1. **ë°±í…ŒìŠ¤íŒ…**ê³¼ ê°™ì´ ìˆ˜ë§Œ ê°œ ì¢…ëª©ì˜ 10ë…„ ì¹˜ ë°ì´í„°ë¥¼ í•œ ë²ˆì— ì½ì–´ì•¼ í•˜ëŠ” ì›Œí¬ë¡œë“œëŠ” I/O íš¨ìœ¨ì´ ê·¹ëŒ€í™”ëœ **Parquet íŒŒì¼**ì„ ì‚¬ìš©í•˜ê³ ,
> 2. **ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§**ì´ë‚˜ **íŠ¹ì • ì¢…ëª©ì˜ ì§€í‘œ ì¡°íšŒ**ì™€ ê°™ì´ ì •êµí•œ í•„í„°ë§ì´ í•„ìš”í•œ ê²½ìš°ì—ëŠ” **TimescaleDB**ë¥¼ í™œìš©í•˜ì—¬ ì‹œìŠ¤í…œì˜ ì„±ëŠ¥ê³¼ ìœ ì—°ì„±ì„ ë™ì‹œì— í™•ë³´í•˜ê² ìŠµë‹ˆë‹¤.
> 
> íŠ¹íˆ, 21ì–µ ê±´ì— ë‹¬í•˜ëŠ” ë°ì´í„°ë¥¼ ë‹¤ë¤„ë³¸ ê²½í—˜ì— ë¹„ì¶”ì–´ ë³¼ ë•Œ, ëª¨ë“  ë°ì´í„°ë¥¼ DBì— ë„£ê³  `JOIN`í•˜ëŠ” ë°©ì‹ì€ ì„±ëŠ¥ ë³‘ëª©ì„ ìœ ë°œí•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ **ë°ì´í„°ì˜ ì„±ê²©ì— ë”°ë¥¸ ì €ì¥ì†Œ ë¶„ë¦¬(Polyglot Persistence)**ê°€ í•µì‹¬ì´ë¼ê³  ìƒê°í•©ë‹ˆë‹¤."

---

## ğŸ’» Python ì˜ˆì‹œ: í•˜ì´ë¸Œë¦¬ë“œ ì²˜ë¦¬ ë¡œì§

```python
import pandas as pd
from sqlalchemy import create_engine

# 1. ë©”íƒ€ë°ì´í„° ì¡°íšŒ (PostgreSQL)
engine = create_engine('postgresql://user:password@localhost:5432/quant_db')
target_stocks = pd.read_sql("SELECT symbol FROM stocks WHERE sector = 'IT'", engine)

# 2. ëŒ€ëŸ‰ ì‹œê³„ì—´ ë°ì´í„° ë¡œë“œ (S3/Local Parquet)
# DB ì¿¼ë¦¬ë³´ë‹¤ ìˆ˜ì‹­ ë°° ë¹ ë¦„
historical_data = pd.read_parquet('s3://my-quant-bucket/refined_data/2023_all_stocks.parquet')

# 3. ë°ì´í„° ë³‘í•© ë° ë°±í…ŒìŠ¤íŒ… ìˆ˜í–‰
final_df = historical_data[historical_data['symbol'].isin(target_stocks['symbol'])]
```

ì´ ë¬¸ì„œëŠ” ë°ì´í„°ì˜ íš¨ìœ¨ì ì¸ ê´€ë¦¬ì™€ ì „ë‹¬ì— ëŒ€í•œ ê¸°ìˆ ì  ê²¬í•´ë¥¼ ë³´ì—¬ì£¼ë©°, ëŒ€ê·œëª¨ ì‹œìŠ¤í…œì„ ì„¤ê³„í•´ë³¸ ì—”ì§€ë‹ˆì–´ë¡œì„œì˜ ë©´ëª¨ë¥¼ ë¶€ê°í•´ì¤ë‹ˆë‹¤.
